### 项目名称: FloatingCopilot（浮动助手）

#### 1. 项目简介（已更新）

FloatingCopilot 是一款面向 Chrome / Edge 的多模式智能 AI 助手。通过“划词翻译、悬浮翻译、全局快捷键”多种方式，快速完成翻译、总结、润色、分析或自定义指令。支持接入多种第三方 AI 服务（如 Google Gemini、OpenAI GPT 等），以灵活、小巧的浮动 Copilot 提升信息处理效率。

核心价值：在不同场景（网页/桌面）都能便捷调用 AI，减少上下文切换成本。

#### 2. 主要功能（保持）

- 悬浮翻译：鼠标悬停在段落上，按下触发键（默认 Alt）进行翻译。
- 划词翻译：选中文本后可打开插件窗口进行处理。
- 全局助手窗口：通过全局快捷键呼出独立弹窗，输入任意文本执行任务。

新增：
- 多渠道与多模型：可添加多个 AI 渠道（OpenAI/Gemini/兼容），每个渠道配置多个模型；支持设置“默认模型”和“翻译模型”。
- 模型切换：在全局助手窗口选择期望的 `渠道 • 模型` 执行任务。
- 目标语言与显示方式：可设置翻译目标语言，以及结果显示为“段落下方插入”或“悬浮卡片”。
- 任务类型下拉：全局助手窗口支持 翻译/总结/改写/润色 四类任务，并联动模板生成提示词。

#### 3. 架构概览（Manifest V3）

- `manifest.json`：权限、命令与脚本声明（已移除缺失图标引用）。
- `content/`：页面内交互（悬浮/划词），向后台发送任务请求。
- `background.js`：统一处理命令、窗口管理与（占位的）AI 请求模拟。
- `window/`：全局助手弹窗的 UI 与交互逻辑。
- `options/`：设置页（API Key、悬浮触发键等）。

#### 4. 本地加载与验证

1) Chrome/Edge 访问 `chrome://extensions`，开启“开发者模式”。
2) 选择“加载已解压的扩展程序”，指向本项目根目录。
3) 在 `chrome://extensions/shortcuts` 绑定 `open-global-window`（默认 Ctrl+Shift+O）。
4) 访问任意网页：
   - 按 Alt + 悬浮在段落上，控制台可见模拟翻译日志。
   - 选中文本，控制台可见划词日志。
5) 按快捷键呼出全局助手，输入文本点击“翻译/总结”，可见模拟结果。

说明：当前 AI 请求为占位实现（本地模拟），后续可在 `background.js` 中接入实际 API。

#### 5. 渠道与模型配置

1) 打开扩展设置页：
   - 在“AI 渠道管理”中查看已配置的渠道；
   - 在“添加渠道”里输入：接口类型、唯一的渠道名称、API URL（可留空采用默认）、API KEY、Models（逗号分隔）。
2) 在“默认模型设置”里：
   - “默认模型”用于窗口等通用任务；
   - “翻译模型”用于页面悬浮/划词翻译优先使用；
   - 两者选择项为“渠道 • 模型”组合。
3) 在全局助手窗口可直接切换“模型”，优先于默认配置。

#### 6. 翻译与显示设置

- 翻译目标语言：在设置页“翻译与显示”中填写（默认“中文”）。后台会据此构建提示词，适配不同语言。
- 结果显示方式：选择“段落下方插入”或“悬浮卡片”。
  - 悬浮翻译：遵循上述显示方式；
  - 划词翻译：默认使用悬浮卡片显示，便于贴近选区查看。

#### 7. Prompt 模板

- 在设置页“Prompt 模板”中可编辑不同任务的提示模板，支持占位符：`{{targetLang}}` 与 `{{text}}`。
- 已内置模板：翻译/总结/改写/润色。窗口选择“任务类型”时将联动对应模板。
