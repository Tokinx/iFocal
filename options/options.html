<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>FloatingCopilot 设置</title>
  <link rel="stylesheet" href="../styles/tailwind.css">
  <link rel="stylesheet" href="../styles/theme.css">
  <link rel="stylesheet" href="options.css">
</head>
<body class="min-h-screen bg-slate-50">
  <div class="max-w-3xl mx-auto p-4 space-y-4">
    <h1 class="text-lg font-bold text-slate-900 header-title">FloatingCopilot 设置</h1>

    <div class="glass rounded-xl p-4 shadow">
      <h2 class="text-base font-semibold mb-2">AI 渠道管理</h2>
      <table id="channelsTable" style="width:100%; border-collapse: collapse;">
        <thead>
          <tr>
            <th class="text-left border-gray-200 border-b py-2">名称</th>
            <th class="text-left border-gray-200 border-b py-2">类型</th>
            <th class="text-left border-gray-200 border-b py-2">模型</th>
            <th class="text-left border-gray-200 border-b py-2">测试模型</th>
            <th class="text-left border-gray-200 border-b py-2">操作</th>
          </tr>
        </thead>
        <tbody id="channelsTbody"></tbody>
      </table>
    </div>

    <div class="glass rounded-xl p-4 shadow" id="editContainer" style="display:none;">
      <h2 class="text-base font-semibold mb-2">编辑渠道</h2>
      <input type="hidden" id="editOriginalName" />
      <p>
        接口类型：
        <select id="editChannelType">
          <option value="openai">OpenAI</option>
          <option value="gemini">Google Gemini</option>
          <option value="openai-compatible">OpenAI 兼容</option>
        </select>
      </p>
      <p>渠道名称（唯一）：<input type="text" id="editChannelName"></p>
      <p>API URL：<input type="text" id="editApiUrl"></p>
      <p>API KEY：<input type="password" id="editApiKey" placeholder="留空表示不变"></p>
      <p>Models（每行一个）：
        <textarea id="editModels" style="width:100%;height:80px;" placeholder="每行一个模型"></textarea>
      </p>
      <div class="flex items-center gap-2 mt-2">
        <button id="saveEditBtn" class="btn btn-primary">保存修改</button>
        <button id="cancelEditBtn" class="btn btn-ghost">取消</button>
        <span id="editStatus" class="text-sm subtle"></span>
      </div>
    </div>

    <div class="glass rounded-xl p-4 shadow">
      <h2 class="text-base font-semibold mb-2">添加渠道</h2>
      <p>
        接口类型：
        <select id="channelType">
          <option value="openai">OpenAI</option>
          <option value="gemini">Google Gemini</option>
          <option value="openai-compatible">OpenAI 兼容</option>
        </select>
      </p>
      <p>渠道名称（唯一）：<input type="text" id="channelName" placeholder="如 my-openai"></p>
      <p>API URL：<input type="text" id="apiUrl" placeholder="可留空使用默认，或填自定义"></p>
      <p>API KEY：<input type="password" id="apiKey" placeholder="在此输入 API Key"></p>
      <p>Models（每行一个）：
        <textarea id="models" style="width:100%;height:80px;" placeholder="例如：
gpt-4o-mini
gpt-4o
..."></textarea>
      </p>
      <div class="flex items-center gap-2 mt-2">
        <button id="addChannelBtn" class="btn btn-primary">添加渠道</button>
        <span id="channelStatus" class="text-sm subtle"></span>
      </div>
    </div>

    <div class="glass rounded-xl p-4 shadow">
      <h2 class="text-base font-semibold mb-2">默认模型设置</h2>
      <p>
        默认模型：
        <select id="defaultModelSelect"></select>
      </p>
      <p>
        翻译模型：
        <select id="translateModelSelect"></select>
      </p>
      <div class="flex items-center gap-2 mt-2">
        <button id="saveGlobalBtn" class="btn btn-primary">保存全局设置</button>
        <span id="globalStatus" class="text-sm subtle"></span>
      </div>
    </div>

    <div class="glass rounded-xl p-4 shadow">
      <h2 class="text-base font-semibold mb-2">快捷键与显示</h2>
      <p>页面翻译快捷键：<input type="text" id="actionKey" placeholder="如 Alt"></p>
      <p>全局快捷键请在 <a href="chrome://extensions/shortcuts" target="_blank">chrome://extensions/shortcuts</a> 中配置。</p>
      <h3 class="mt-2">翻译与显示</h3>
      <p>翻译目标语言：
        <select id="translateTargetLang" class="select">
          <option value="zh-CN">zh-CN</option>
          <option value="en">en</option>
          <option value="ja">ja</option>
          <option value="ko">ko</option>
          <option value="fr">fr</option>
          <option value="es">es</option>
          <option value="de">de</option>
        </select>
      </p>
      <p>
        结果显示方式：
        <select id="displayMode">
          <option value="insert">段落下方插入</option>
          <option value="overlay">悬浮卡片</option>
        </select>
      </p>
      <h3 class="mt-2">译文样式（floating-copilot-target-wrapper）</h3>
      <p class="text-sm subtle">可填写 CSS 声明，将用于悬浮翻译插入的包裹节点内联样式。</p>
      <textarea id="wrapperStyle" style="width:100%;height:90px;" placeholder="background-image: linear-gradient(to right, rgba(71,71,71,.5) 30%, rgba(255,255,255,0) 0%);
background-position: bottom;
background-size: 5px 1px;
background-repeat: repeat-x;
padding-bottom: 3px;
font-family: inherit;"></textarea>
      <div class="flex items-center gap-2 mt-2">
        <button id="save" class="btn btn-primary">保存设置</button>
        <span id="status" class="text-sm subtle"></span>
      </div>
    </div>

    <div class="glass rounded-xl p-4 shadow">
      <h2 class="text-base font-semibold mb-2">Prompt 模板</h2>
      <p class="text-sm subtle">可使用占位符：<code>{{'{{'}}targetLang{{'}}'}}</code> 与 <code>{{'{{'}}text{{'}}'}}</code>。</p>
      <p>
        翻译模板：
        <textarea id="tplTranslate" style="width:100%;height:90px;" placeholder="请将以下内容高质量翻译为{{'{{'}}targetLang{{'}}'}}，只返回译文：

{{'{{'}}text{{'}}'}}"></textarea>
      </p>
      <p>
        总结模板：
        <textarea id="tplSummarize" style="width:100%;height:90px;" placeholder="请用{{'{{'}}targetLang{{'}}'}}总结以下内容的要点，只返回总结：

{{'{{'}}text{{'}}'}}"></textarea>
      </p>
      <p>
        改写模板：
        <textarea id="tplRewrite" style="width:100%;height:90px;" placeholder="请用{{'{{'}}targetLang{{'}}'}}改写以下内容，使其表达清晰准确且保持原意：

{{'{{'}}text{{'}}'}}"></textarea>
      </p>
      <p>
        润色模板：
        <textarea id="tplPolish" style="width:100%;height:90px;" placeholder="请用{{'{{'}}targetLang{{'}}'}}润色以下内容，使其更加自然流畅并提升可读性：

{{'{{'}}text{{'}}'}}"></textarea>
      </p>
      <div class="flex items-center gap-2 mt-2">
        <button id="saveTemplatesBtn" class="btn btn-primary">保存模板</button>
        <button id="resetTemplatesBtn" class="btn btn-ghost">恢复默认</button>
        <span id="tplStatus" class="text-sm subtle"></span>
      </div>
    </div>

  </div>

  <script src="options.js"></script>
</body>
</html>
